---
tags: Java, Basic, Collections, Iterable, Iterator, ListIterator, Fail-fast, Weakly-consistent
title: Interfaces Iterable, Iterator and ListIterator
---
# Iterable\<E>, Iterator\<E> и ListIterator\<E>

## Iterable\<E>
:::info
Классы реализующие интерфейс можно использовать в foreach.
:::

### Методы

| Сигнатура                                  | Описание                                        |
| ------------------------------------------ | ----------------------------------------------- |
| `Iterator<E> iterator()`                   | Возвращает итератор для коллекции               |
| `void forEach(Consumer<? super E> action)` | Вызывает для каждого элемента `action.accept()` |
| `Spliterator<T> spliterator()`             | Возвращает [сплитератор](https://hackmd.io/EkGRPyUISQaRQfIa4j3IOA?view)                          |



## Iterator\<E>
Итератор – это специальный внутренний объект в коллекции, который с одной стороны имеет доступ ко всем ее private данным и знает ее внутреннюю структуру, с другой – реализует общедоступный интерфейс Iterator, благодаря чему все знают, как с ним работать.

### Fail-fast и weakly-consistent
Итераторы с поведением ++fail-fast++ кидают исключение при модификации коллекций (в основном это все из *java.util*). Для этого коллекции хранят счётчик *modCount* инкременирующийся при любых изменениях в коллекции. Если итератор видит, что счётчик изменился, то он кидает *ConcurrentModificationException*.


Большинство конкурентных коллекций из пакета java.util.concurrent (например, ConcurrentHashMap и большинство Queue) предоставляют слабо согласованные итераторы (++weakly-consistent++):

* Они могут обрабатываться конкурентно с другими операциями
* Они никогда не генерируют исключение ConcurrentModificationException
* Они гарантированно обходят существовавшие на момент создания итератора элементы ровно один раз, и могут (но не обязаны) отражать последующие модификации.


### Методы

| Сигнатура                                      | Описание                                                                                                                                                                                                                              |
| ---------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `boolean hasNext()`                            | Возвращает *true* если метод `next()` вернёт ещё элемент                                                                                                                                                                              |
| `E next()`                                     | Возвращает следующий элемент. Если элемента нет, то кидает исключение *NoSuchElementException*                                                                                                                                        |
| `void remove()`                                | Удаляет последний элемент вернутый `next()`. По умолчанию (default) данная реализация кидает *UnsupportedOperationException*. Кидает *IllegalStateException* если не был вызван метод `next()` или после повторного вызова `remove()` |
| `forEachRemaining(Consumer<? super E> action)` | forEach для оставшихся элементов в итераторе                                                                                                                                                                                          |


## ListIterator\<E>
Используется для листов и позволяет ходить в разные стороны.
Наследуется от Iterator\<E>.
Можно получить у List с помощью метода `ListIterator<E> listIterator()` или `ListIterator<E> listIterator(int index)`.

| Метод                   | Описание                                 |
| ----------------------- | ---------------------------------------- |
| `boolean hasNext()`     | Проверяет, есть ли еще элементы впереди. |
| `E next()`              | Возвращает следующий элемент.            |
| `int nextIndex()`       | Возвращает индекс следующего элемента    |
| `void set(E e)`         | Меняет значение текущего элемента        |
| `boolean hasPrevious()` | Проверяет, есть ли элементы позади.      |
| `E previous()`          | Возвращает предыдущий элемент            |
| `int previousIndex()`   | Возвращает индекс предыдущего элемента   |
| `void remove()`         | Удаляет текущий элемент                  |
| `void add(E e)`         | Добавляет элемент в список сразу за текущим. В `next()` эти элементы не попадут              |